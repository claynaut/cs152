program                     : functions                                            
                            ;

functions                   : function functions                                  
                            | EPSILON                                      
                            ;
    
function                    : FUNCTION IDENTIFIER SEMICOLON 
                              BEGIN_PARAMS declarations END_PARAMS 
                              BEGIN_LOCALS declarations END_LOCALS 
                              BEGIN_BODY statements END_BODY                        
                            ;

declarations                : declaration SEMICOLON declarations                  
                            | EPSILON                                  
                            ;

declaration                 : identifiers COLON declaration_params INTEGER      
                            ;

declaration_params          : ENUM L_PAREN identifiers R_PAREN                      
                            | ARRAY L_SQUARE_BRACKET NUMBER R_SQUARE_BRACKET OF    
                            | EPSILON                                        
                            ;

identifiers                 : IDENTIFIER identifiers                           
                            | COMMA IDENTIFIER identifiers                    
                            | EPSILON                                        
                            ;

statements                  : statement SEMICOLON statements                     
                            | EPSILON                                        
                            ;

statement                   : var ASSIGN expr                                      
                            | IF bool_expr THEN statements ENDIF                    
                            | IF bool_expr THEN statements ELSE statements ENDIF    
                            | WHILE bool_expr BEGINLOOP statements ENDLOOP         
                            | DO BEGINLOOP statements ENDLOOP WHILE bool_expr      
                            | READ vars                                            
                            | WRITE vars                                           
                            | CONTINUE                                             
                            | RETURN expr                                          
                            | EPSILON                                      
                            ;

vars                        : var                                               
                            | var COMMA vars                                    
                            | EPSILON                                      
                            ;
                    
var                         : IDENTIFIER                                           
                            | IDENTIFIER L_SQUARE_BRACKET expr R_SQUARE_BRACKET    
                            ;

bool_expr                   : relation_and_expr bool_expr_params                
                            ;

bool_expr_params            : OR relation_and_expr bool_expr_params               
                            | EPSILON                                       
                            ;

relation_and_expr           : relation_expr relation_and_expr_params              
                            ;

relation_and_expr_params    : AND relation_expr relation_and_expr_params     
                            | EPSILON                                     
                            ;
                        
relation_expr               : relation_exprs                                  
                            | NOT relation_exprs                                
                            ;   

relation_exprs              : expr comp expr                                   
                            | TRUE                                          
                            | FALSE                                                
                            | L_PAREN bool_expr R_PAREN                           
                            ;

comp                        : EQ                                          
                            | NEQ                                         
                            | LT                                       
                            | GT                                              
                            | LTE                                         
                            | GTE                                               
                            ;

expr                        : mult_expr expr_ops                          
                            ;

expr_ops                    : ADD mult_expr expr_ops                          
                            | SUB mult_expr expr_ops                         
                            | EPSILON                                      
                            ;

mult_expr                   : term mult_expr_ops                         
                            ;

mult_expr_ops               : MULT term mult_expr_ops                              
                            | DIV term mult_expr_ops                            
                            | MOD term mult_expr_ops                             
                            | EPSILON                                   
                            ;

term                        : terms                                              
                            | SUB terms                                          
                            | IDENTIFIER L_PAREN exprs R_PAREN                 
                            ;

terms                       : var                                         
                            | NUMBER                                          
                            | L_PAREN expr R_PAREN                           
                            ;

exprs                       : expr                                                  
                            | expr COMMA exprs                                     
                            | EPSILON                                       
                            ;